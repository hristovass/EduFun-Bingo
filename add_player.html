<!DOCTYPE html>
<html lang="sl">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Dodaj igralca</title>
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
        /* LIGHT background */
        body {
            background: linear-gradient(to bottom right, #dbeafe, #f5d0fe, #fef3c7);
        }

        /* Base tab style */
        .tab-btn {
            transition: all 0.15s ease;
        }

        /* LIGHT MODE: —Ü—Ä–Ω —Ç–µ–∫—Å—Ç –°–ï–ö–êDE */
        body:not(.dark) h1,
        body:not(.dark) p,
        body:not(.dark) label,
        body:not(.dark) span,
        body:not(.dark) input,
        body:not(.dark) #message {
            color: #000000 !important;
        }

        body:not(.dark) .tab-btn {
            color: #000000 !important; /* –Ω–µ–∞–∫—Ç–∏–≤–µ–Ω —Ç–∞–± */
        }

        body:not(.dark) .tab-btn span {
            color: inherit !important;
            opacity: 1 !important;
        }

        body:not(.dark) .tab-btn.active {
            background-color: #ffffff !important;
            color: #000000 !important; /* –∞–∫—Ç–∏–≤–µ–Ω —Ç–∞–± */
            font-weight: 700;
        }

        body:not(.dark) .tab-btn.active span {
            color: #000000 !important;
        }

        /* DARK THEME */
        body.dark {
            background: radial-gradient(circle at top, #1f2937, #020617) !important;
            color: #e5e7eb !important;
        }

        body.dark main {
            background-color: #020617 !important;
            border-color: #1f2937 !important;
            box-shadow: 0 25px 50px -12px rgba(0,0,0,0.9) !important;
        }

        body.dark h1,
        body.dark p,
        body.dark label,
        body.dark span {
            color: #e5e7eb !important;
        }

        body.dark input {
            background-color: #020617 !important;
            border-color: #4b5563 !important;
            color: #e5e7eb !important;
        }

        body.dark input::placeholder {
            color: #6b7280 !important;
        }

        body.dark .tab-btn {
            background-color: #020617 !important;
            border-color: #4b5563 !important;
            color: #e5e7eb !important;
        }

        body.dark .tab-btn.active {
            background: linear-gradient(to right, #2563eb, #4f46e5) !important;
            color: #f9fafb !important;
            border-color: transparent !important;
        }

        body.dark button[type="submit"] {
            background: linear-gradient(to right, #2563eb, #4f46e5) !important;
            border-color: transparent !important;
        }

        body.dark button[type="submit"]:hover {
            filter: brightness(1.1);
        }

        /* Tabs wrapper fix za dark */
        body.dark .tabs-wrapper {
            background-color: #020617 !important;
            border: 1px solid #4b5563 !important;
        }
    </style>
    
</head>

<body class="flex items-center justify-center min-h-screen font-sans">
<main class="bg-white/90 backdrop-blur-md rounded-3xl shadow-2xl border border-white/60 p-6 w-full max-w-md space-y-6">
    <!-- Header -->
    <header class="text-center space-y-1">
        <h1
          class="text-2xl font-extrabold tracking-tight
                 bg-gradient-to-r from-blue-600 to-purple-600
                 bg-clip-text text-transparent
                 dark:from-blue-400 dark:to-purple-400">
            Dodaj igralca üë•
        </h1>
        <p class="text-sm text-gray-900 dark:text-gray-300">
            Prijavi se ali ustvari nov raƒçun, da lahko igra≈° Quiz Bingo ‚ú®
        </p>
    </header>

    <!-- Tabs -->
    <div class="tabs-wrapper flex rounded-2xl bg-gray-100 p-1">
        <button
            id="tab-login"
            class="tab-btn active flex-1 px-4 py-2 rounded-xl text-sm font-semibold border border-transparent shadow-sm flex items-center justify-center gap-2">
            <span>üîë</span> <span>Prijava</span>
        </button>
        <button
            id="tab-register"
            class="tab-btn flex-1 px-4 py-2 rounded-xl text-sm font-semibold border border-transparent flex items-center justify-center gap-2">
            <span>üÜï</span> <span>Registracija</span>
        </button>
    </div>

    <!-- Login form -->
    <form id="login-form" class="space-y-4">
        <div class="space-y-1">
            <label for="l_username" class="text-sm font-medium">Uporabni≈°ko ime</label>
            <input
                type="text"
                id="l_username"
                required
                class="w-full px-4 py-2.5 border rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none text-sm"
            />
        </div>

        <div class="space-y-1">
            <label for="l_password" class="text-sm font-medium">Geslo</label>
            <input
                type="password"
                id="l_password"
                required
                class="w-full px-4 py-2.5 border rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none text-sm"
            />
        </div>

        <button
            type="submit"
            class="w-full mt-2 bg-blue-600 text-white py-2.5 rounded-xl hover:bg-blue-700 transition text-sm font-semibold shadow-md">
            Prijava
        </button>
    </form>

    <!-- Register form -->
    <form id="register-form" class="space-y-4 hidden">
        <div class="space-y-1">
            <label for="r_username" class="text-sm font-medium">Uporabni≈°ko ime</label>
            <input
                type="text"
                id="r_username"
                placeholder="npr. maja09"
                required
                class="w-full px-4 py-2.5 border rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none text-sm"
            />
        </div>

        <div class="space-y-1">
            <label for="r_first_name" class="text-sm font-medium">Ime</label>
            <input
                type="text"
                id="r_first_name"
                placeholder="Tvoje ime"
                required
                class="w-full px-4 py-2.5 border rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none text-sm"
            />
        </div>

        <div class="space-y-1">
            <label for="r_last_name" class="text-sm font-medium">Priimek</label>
            <input
                type="text"
                id="r_last_name"
                placeholder="Tvoj priimek"
                required
                class="w-full px-4 py-2.5 border rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none text-sm"
            />
        </div>

        <div class="space-y-1">
            <label for="r_password" class="text-sm font-medium">
                Geslo <span class="text-xs">(vsaj 6 znakov)</span>
            </label>
            <input
                type="password"
                id="r_password"
                placeholder="Vnesi geslo"
                required
                class="w-full px-4 py-2.5 border rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none text-sm"
            />
        </div>

        <button
            type="submit"
            class="w-full mt-2 bg-blue-600 text-white py-2.5 rounded-xl hover:bg-blue-700 transition text-sm font-semibold shadow-md">
            Ustvari raƒçun
        </button>
    </form>

    <!-- Message -->
    <p id="message" class="text-center text-sm min-h-[20px]"></p>
</main>

<script>
    // theme init
    (function initTheme() {
        const theme = localStorage.getItem('theme') || 'light';
        document.body.classList.toggle('dark', theme === 'dark');
    })();

    const registerTab  = document.getElementById('tab-register');
    const loginTab     = document.getElementById('tab-login');
    const registerForm = document.getElementById('register-form');
    const loginForm    = document.getElementById('login-form');
    const msg          = document.getElementById('message');

    function setTab(active) {
        if (active === 'login') {
            loginTab.classList.add('active');
            registerTab.classList.remove('active');
            loginForm.classList.remove('hidden');
            registerForm.classList.add('hidden');
        } else {
            registerTab.classList.add('active');
            loginTab.classList.remove('active');
            registerForm.classList.remove('hidden');
            loginForm.classList.add('hidden');
        }
        msg.textContent = '';
        msg.className = 'text-center text-sm';
    }

    loginTab.addEventListener('click', () => setTab('login'));
    registerTab.addEventListener('click', () => setTab('register'));

    function showMessage(text, ok) {
        msg.textContent = text;
        msg.className = ok
            ? "text-center text-sm text-green-600"
            : "text-center text-sm text-red-600";
    }

    // register
    registerForm.addEventListener('submit', async (e) => {
        e.preventDefault();

        const player = {
            username: r_username.value.trim(),
            first_name: r_first_name.value.trim(),
            last_name: r_last_name.value.trim(),
            password: r_password.value.trim(),
        };

        // custom –æ–≥—Ä–∞–Ω–∏—á—É–≤–∞—ö–µ: –º–∏–Ω–∏–º—É–º 6 znakov, –±–µ–∑ browser popup
        if (player.password.length < 6) {
            showMessage("‚ùå Geslo mora imeti vsaj 6 znakov.", false);
            return;
        }

        showMessage("‚è≥ Registriram...", true);

        const res = await window.api.registerPlayer(player);

        if (res.success) {
            showMessage("‚úÖ Registracija uspe≈°na! Sedaj —Å–µ prijavi.", true);
            setTab("login");
        } else {
            showMessage("‚ùå " + (res.error || "Napaka pri registraciji"), false);
        }
    });

    // login
    loginForm.addEventListener('submit', async (e) => {
        e.preventDefault();

        const creds = {
            username: l_username.value.trim(),
            password: l_password.value.trim()
        };

        showMessage("‚è≥ Prijavljam...", true);

        const res = await window.api.loginPlayer(creds);

        if (res.success) {
            showMessage("‚úÖ Prijava uspe≈°na!", true);
        } else {
            showMessage("‚ùå " + (res.error || "Napaka pri prijavi"), false);
        }
    });
</script>
</body>
</html>
